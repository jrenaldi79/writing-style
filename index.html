<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Writing Style Clone</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 50px 20px;
            text-align: center;
        }
        .header h1 { font-size: 2.8rem; margin-bottom: 12px; }
        .header p { font-size: 1.2rem; opacity: 0.9; max-width: 600px; margin: 0 auto; }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        /* Section styling */
        .section { margin-bottom: 50px; }
        .section-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-title .icon { font-size: 1.4rem; }
        
        /* Cards */
        .card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-bottom: 16px;
        }
        
        /* Why section */
        .why-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .why-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        .why-item .problem {
            color: #999;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }
        .why-item .solution {
            color: #333;
            font-weight: 500;
        }
        
        /* Setup steps */
        .setup-steps {
            counter-reset: step;
        }
        .setup-step {
            position: relative;
            padding-left: 70px;
            margin-bottom: 30px;
        }
        .setup-step::before {
            counter-increment: step;
            content: counter(step);
            position: absolute;
            left: 0;
            top: 0;
            background: #667eea;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            font-weight: bold;
        }
        .setup-step h3 {
            font-size: 1.15rem;
            margin-bottom: 10px;
            color: #333;
        }
        .setup-step p { color: #555; margin-bottom: 12px; }
        
        /* Prompt box */
        .prompt-box {
            background: #1e1e1e;
            border-radius: 10px;
            padding: 20px;
            position: relative;
            margin-top: 12px;
        }
        .prompt-box code {
            color: #e6e6e6;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 0.85rem;
            line-height: 1.5;
            white-space: pre-wrap;
            display: block;
        }
        .prompt-box .copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: #444;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        .prompt-box .copy-btn:hover { background: #555; }
        .prompt-box .copy-btn.copied { background: #4CAF50; }
        
        .id-highlight {
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'SF Mono', Monaco, monospace;
            font-weight: bold;
        }
        
        /* CTA button */
        .cta-button {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            padding: 14px 32px;
            border-radius: 10px;
            text-decoration: none;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.35);
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 12px;
        }
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.45);
        }
        .cta-button.secondary {
            background: #555;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .cta-button.secondary:hover {
            background: #666;
        }
        
        /* Key concept banner */
        .key-concept {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 2px solid #4CAF50;
            border-radius: 12px;
            padding: 20px 24px;
            text-align: center;
            margin-bottom: 24px;
        }
        .key-concept strong { color: #2E7D32; }
        
        .warning-concept {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border: 2px solid #ff9800;
            border-radius: 12px;
            padding: 20px 24px;
            margin-bottom: 24px;
        }
        .warning-concept strong { color: #e65100; }
        
        /* Workflow sections */
        .workflow-section {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            background: white;
        }
        .workflow-section.first-time {
            border-color: #667eea;
            background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
        }
        .workflow-section.maintenance {
            border-color: #9e9e9e;
        }
        .workflow-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid rgba(0,0,0,0.1);
        }
        .workflow-header h3 {
            font-size: 1.2rem;
            margin: 0;
        }
        .workflow-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        .badge-required {
            background: #667eea;
            color: white;
        }
        .badge-optional {
            background: #e0e0e0;
            color: #666;
        }
        
        /* Phases */
        .phase {
            display: grid;
            grid-template-columns: 56px 1fr;
            gap: 20px;
            align-items: start;
            margin-bottom: 20px;
        }
        .phase-number {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .phase-1 .phase-number { background: #4CAF50; }
        .phase-2 .phase-number { background: #2196F3; }
        .phase-3 .phase-number { background: #FF9800; }
        
        .phase-content h4 {
            font-size: 1.1rem;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .phase-1 h4 { color: #2E7D32; }
        .phase-2 h4 { color: #1565C0; }
        .phase-3 h4 { color: #E65100; }
        
        .phase-meta { font-size: 0.85rem; color: #888; margin-bottom: 10px; }
        .phase-details { color: #555; font-size: 0.95rem; }
        .phase-details ul {
            margin-top: 8px;
            margin-left: 20px;
        }
        .phase-details li { margin-bottom: 4px; }
        
        .new-chat-alert {
            background: #ffebee;
            border: 2px solid #f44336;
            border-radius: 8px;
            padding: 12px 16px;
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .new-chat-alert .icon { font-size: 1.2rem; }
        .new-chat-alert strong { color: #c62828; }
        
        .phase-actions {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }
        
        .arrow {
            text-align: center;
            font-size: 1.5rem;
            color: #667eea;
            margin: -8px 0 12px 28px;
            font-weight: bold;
        }
        
        /* Output box */
        .output {
            background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%);
            border: 2px solid #9C27B0;
            border-radius: 12px;
            padding: 28px;
            text-align: center;
        }
        .output-icon { font-size: 2.5rem; margin-bottom: 10px; }
        .output h3 { color: #6A1B9A; font-size: 1.3rem; margin-bottom: 8px; }
        .output p { color: #555; font-size: 0.95rem; }
        .output code {
            background: rgba(0,0,0,0.1);
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        /* Comparison */
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .comparison-box h4 { margin-bottom: 14px; font-size: 1.05rem; }
        .comparison-box.before { border-left: 4px solid #ccc; }
        .comparison-box.before h4 { color: #999; }
        .comparison-box.after { border-left: 4px solid #4CAF50; }
        .comparison-box.after h4 { color: #4CAF50; }
        .comparison-box blockquote {
            font-style: italic;
            color: #555;
            line-height: 1.7;
            padding-left: 16px;
            font-size: 0.95rem;
        }
        
        /* File structure */
        .file-structure {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.85rem;
            line-height: 1.8;
            overflow-x: auto;
        }
        .file-structure .comment { color: #6a737d; }
        .file-structure .highlight { color: #9C27B0; font-weight: bold; }
        
        /* Troubleshooting */
        .troubleshoot-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 12px 20px;
            font-size: 0.95rem;
        }
        .troubleshoot-grid .issue {
            color: #666;
            font-weight: 500;
        }
        .troubleshoot-grid .solution { color: #333; }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 30px 20px;
            color: #999;
            font-size: 0.9rem;
        }
        .footer a { color: #667eea; text-decoration: none; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .header p { font-size: 1rem; }
            .why-grid, .comparison { grid-template-columns: 1fr; }
            .phase { grid-template-columns: 1fr; }
            .phase-number { margin-bottom: 10px; }
            .troubleshoot-grid { grid-template-columns: 1fr; }
            .troubleshoot-grid .issue { margin-top: 10px; }
            .setup-step { padding-left: 60px; }
            .setup-step::before { width: 44px; height: 44px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Writing Style Clone v2</h1>
        <p>Train AI to write in your authentic voice using mathematical clustering and validated persona discovery</p>
    </div>
    
    <div class="container">
        
        <!-- What's New -->
        <div class="section">
            <h2 class="section-title"><span class="icon">üöÄ</span> What's New in v2</h2>
            <div class="card">
                <table style="width: 100%; border-collapse: collapse;">
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 12px; font-weight: 600; color: #999;">Feature</td>
                        <td style="padding: 12px; font-weight: 600; color: #999;">v1 (Vibes)</td>
                        <td style="padding: 12px; font-weight: 600; color: #4CAF50;">v2 (Mathematical)</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 12px;">Clustering</td>
                        <td style="padding: 12px; color: #999;">Agent decides</td>
                        <td style="padding: 12px; color: #4CAF50; font-weight: 500;">‚úÖ Embeddings + HDBSCAN</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 12px;">Scoring</td>
                        <td style="padding: 12px; color: #999;">Inconsistent</td>
                        <td style="padding: 12px; color: #4CAF50; font-weight: 500;">‚úÖ Calibration anchors</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 12px;">Input Quality</td>
                        <td style="padding: 12px; color: #999;">All emails</td>
                        <td style="padding: 12px; color: #4CAF50; font-weight: 500;">‚úÖ Garbage filtered</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 12px;">Context</td>
                        <td style="padding: 12px; color: #999;">None</td>
                        <td style="padding: 12px; color: #4CAF50; font-weight: 500;">‚úÖ Recipient-aware</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px;">Validation</td>
                        <td style="padding: 12px; color: #999;">Hope it works</td>
                        <td style="padding: 12px; color: #4CAF50; font-weight: 500;">‚úÖ Similarity scoring</td>
                    </tr>
                </table>
            </div>
        </div>
        
        <!-- Why -->
        <div class="section">
            <h2 class="section-title"><span class="icon">‚ú®</span> Why Use It?</h2>
            <div class="why-grid">
                <div class="why-item">
                    <div class="problem">‚ùå AI writing sounds generic and robotic</div>
                    <div class="solution">‚úÖ AI learns <em>your</em> specific patterns and phrases</div>
                </div>
                <div class="why-item">
                    <div class="problem">‚ùå You write differently for different audiences</div>
                    <div class="solution">‚úÖ AI recognizes your distinct "personas" and switches between them</div>
                </div>
                <div class="why-item">
                    <div class="problem">‚ùå Editing AI output to sound like you takes forever</div>
                    <div class="solution">‚úÖ AI gets it right the first time</div>
                </div>
                <div class="why-item">
                    <div class="problem">‚ùå Generic greetings and sign-offs</div>
                    <div class="solution">‚úÖ Uses your actual greeting and closing patterns</div>
                </div>
            </div>
        </div>
        
        <!-- One-Time Setup -->
        <div class="section">
            <h2 class="section-title"><span class="icon">üöÄ</span> One-Time Setup (2 minutes)</h2>
            
            <div class="key-concept">
                <strong>‚ú® Create once, click to launch.</strong> After setup, all buttons below will open the right assistant automatically.
            </div>
            
            <div class="setup-steps">
                <div class="setup-step">
                    <h3>Create a ChatWise Assistant</h3>
                    <p>In ChatWise, create a new assistant with:</p>
                    <ul style="margin-left: 20px; margin-bottom: 12px;">
                        <li><strong>ID:</strong> <span class="id-highlight">writing-style</span> (this exact ID is required for the buttons to work)</li>
                        <li><strong>Name:</strong> Writing Style Clone (or whatever you prefer)</li>
                    </ul>
                    <p>For the system prompt, copy and paste this:</p>
                    
                    <div class="prompt-box">
                        <button class="copy-btn" onclick="copyPrompt(this, 'system-prompt')">Copy</button>
                        <code id="system-prompt">Loading...</code>
                    </div>
                </div>
                
                <div class="setup-step">
                    <h3>Save the Assistant</h3>
                    <p>Click Save. You're done with setup!</p>
                    <p>Now all the buttons below will automatically open your <span class="id-highlight">writing-style</span> assistant.</p>
                </div>
            </div>
        </div>
        
        <!-- Workflow -->
        <div class="section">
            <h2 class="section-title"><span class="icon">üîÑ</span> The Workflow</h2>
            
            <div class="warning-concept">
                <strong>‚ö†Ô∏è Important:</strong> Start a <strong>new conversation</strong> after each phase. Just click the next button!
            </div>
            
            <!-- First Time -->
            <div class="workflow-section first-time">
                <div class="workflow-header">
                    <h3>üéØ First Time Setup</h3>
                    <span class="workflow-badge badge-required">Required ‚Ä¢ ~30 minutes total</span>
                </div>
                <p style="margin-bottom: 20px; color: #555;">Complete all three phases in order. Click each button to start a new conversation.</p>
                
                <div class="phase phase-1">
                    <div class="phase-number">1</div>
                    <div class="phase-content">
                        <h4>Setup + Preprocessing</h4>
                        <p class="phase-meta">~10 minutes</p>
                        <div class="phase-details">
                            <p>Installs the skill, downloads emails, and runs preprocessing pipeline.</p>
                            <ul>
                                <li>AI asks how many emails (suggest 100-150)</li>
                                <li><strong>NEW:</strong> Filters garbage (15-20% rejection)</li>
                                <li><strong>NEW:</strong> Enriches with recipient metadata</li>
                                <li><strong>NEW:</strong> Generates embeddings and clusters mathematically</li>
                                <li>Fully automated ‚Äî just wait for completion</li>
                            </ul>
                        </div>
                        <div class="phase-actions">
                            <a href="chatwise://chat?assistant=writing-style&input=Clone%20my%20writing%20style" class="cta-button">üöÄ Start Phase 1</a>
                        </div>
                        <div class="new-chat-alert">
                            <span class="icon">üîÑ</span>
                            <span><strong>When complete:</strong> Close this chat. Click the Phase 2 button below.</span>
                        </div>
                    </div>
                </div>
                
                <div class="arrow">‚Üì New Conversation</div>
                
                <div class="phase phase-2">
                    <div class="phase-number">2</div>
                    <div class="phase-content">
                        <h4>Analysis</h4>
                        <p class="phase-meta">~15-20 minutes</p>
                        <div class="phase-details">
                            <p>Analyzes pre-clustered emails with calibrated scoring to discover personas.</p>
                            <ul>
                                <li><strong>NEW:</strong> AI reads calibration anchors for consistent scoring</li>
                                <li><strong>NEW:</strong> Analyzes one mathematical cluster at a time</li>
                                <li><strong>NEW:</strong> Tone vectors (1-10 scales) for formality, warmth, authority, directness</li>
                                <li><strong>Goal:</strong> All clusters analyzed (typically 3-5 batches)</li>
                                <li><strong>When done:</strong> Say "I'm ready to generate"</li>
                            </ul>
                        </div>
                        <div class="phase-actions">
                            <a href="chatwise://chat?assistant=writing-style&input=Continue%20cloning%20my%20writing%20style" class="cta-button">üöÄ Start Phase 2</a>
                        </div>
                        <div class="new-chat-alert">
                            <span class="icon">üîÑ</span>
                            <span><strong>When complete:</strong> Close this chat. Click the Phase 3 button below.</span>
                        </div>
                    </div>
                </div>
                
                <div class="arrow">‚Üì New Conversation</div>
                
                <div class="phase phase-3">
                    <div class="phase-number">3</div>
                    <div class="phase-content">
                        <h4>Generate + Validate</h4>
                        <p class="phase-meta">~7 minutes</p>
                        <div class="phase-details">
                            <p>Creates your personalized writing assistant prompt and validates it.</p>
                            <ul>
                                <li>Synthesizes personas into production-ready prompt</li>
                                <li><strong>NEW:</strong> Runs automatic validation against held-out samples</li>
                                <li><strong>NEW:</strong> Reports similarity scores and improvement suggestions</li>
                                <li>Iterates if needed until validation passes</li>
                            </ul>
                        </div>
                        <div class="phase-actions">
                            <a href="chatwise://chat?assistant=writing-style&input=Generate%20my%20writing%20assistant" class="cta-button">üöÄ Start Phase 3</a>
                        </div>
                    </div>
                </div>
                
                <div class="output" style="margin-top: 24px;">
                    <div class="output-icon">üéØ</div>
                    <h3>Your Personalized Writing Assistant</h3>
                    <p>Output: <code>~/Documents/my-writing-style/prompts/writing_assistant.md</code></p>
                    <p style="margin-top: 8px;">Use with ChatGPT, Claude, or any AI writing tool</p>
                </div>
            </div>
            
            <!-- Maintenance -->
            <div class="workflow-section maintenance">
                <div class="workflow-header">
                    <h3>üîß Ongoing Maintenance</h3>
                    <span class="workflow-badge badge-optional">Optional ‚Ä¢ After initial setup</span>
                </div>
                <p style="margin-bottom: 16px; color: #555;">Keep your writing assistant up to date as your style evolves.</p>
                
                <table style="width: 100%; border-collapse: collapse; margin-top: 16px;">
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 12px 0; font-weight: 500; color: #666; width: 120px;">Monthly</td>
                        <td style="padding: 12px 0;">
                            Fetch new emails and analyze them<br>
                            <a href="chatwise://chat?assistant=writing-style&input=Fetch%20my%20new%20emails%20and%20analyze%20them" class="cta-button secondary" style="margin-top: 8px; font-size: 0.9rem; padding: 10px 20px;">üìß Fetch & Analyze New</a>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 12px 0; font-weight: 500; color: #666;">Quarterly</td>
                        <td style="padding: 12px 0;">
                            Regenerate your writing assistant with new patterns<br>
                            <a href="chatwise://chat?assistant=writing-style&input=Regenerate%20my%20writing%20assistant" class="cta-button secondary" style="margin-top: 8px; font-size: 0.9rem; padding: 10px 20px;">üîÑ Regenerate</a>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        
        <!-- Before/After -->
        <div class="section">
            <h2 class="section-title"><span class="icon">üìù</span> The Difference</h2>
            <div class="comparison">
                <div class="card comparison-box before">
                    <h4>‚ùå Generic AI</h4>
                    <blockquote>
                        Dear Team,<br><br>
                        I hope this email finds you well. I wanted to reach out regarding our upcoming project timeline. Please let me know if you have any questions.<br><br>
                        Best regards
                    </blockquote>
                </div>
                <div class="card comparison-box after">
                    <h4>‚úÖ Your Voice</h4>
                    <blockquote>
                        Team,<br><br>
                        Quick update on Q2 priorities. We're shifting focus to the customer dashboard‚ÄîI'll share the full roadmap in Thursday's all-hands.<br><br>
                        Three things I need by EOD Wednesday: [...]<br><br>
                        -John
                    </blockquote>
                </div>
            </div>
        </div>
        
        <!-- File Structure -->
        <div class="section">
            <h2 class="section-title"><span class="icon">üìÅ</span> What Gets Created</h2>
            <div class="card">
                <div class="file-structure">
~/Documents/<br>
‚îú‚îÄ‚îÄ writing-style/ <span class="comment"># The skill (auto-downloaded)</span><br>
‚îÇ   ‚îú‚îÄ‚îÄ skill/SKILL.md<br>
‚îÇ   ‚îî‚îÄ‚îÄ index.html <span class="comment"># This guide</span><br>
‚îÇ<br>
‚îî‚îÄ‚îÄ my-writing-style/ <span class="comment"># Your personal data</span><br>
    ‚îú‚îÄ‚îÄ raw_samples/ <span class="comment"># Downloaded emails</span><br>
    ‚îú‚îÄ‚îÄ batches/ <span class="comment"># Analysis JSON output</span><br>
    ‚îú‚îÄ‚îÄ fetch_state.json <span class="comment"># Tracks which emails fetched</span><br>
    ‚îú‚îÄ‚îÄ state.json <span class="comment"># Tracks workflow progress</span><br>
    ‚îú‚îÄ‚îÄ persona_registry.json <span class="comment"># Discovered personas</span><br>
    ‚îú‚îÄ‚îÄ samples/ <span class="comment"># Analyzed writing</span><br>
    ‚îî‚îÄ‚îÄ prompts/<br>
        ‚îî‚îÄ‚îÄ <span class="highlight">writing_assistant.md ‚Üê YOUR OUTPUT</span>
                </div>
            </div>
        </div>
        
        <!-- Technical Details -->
        <div class="section">
            <h2 class="section-title"><span class="icon">üî¨</span> Technical Details</h2>
            <div class="card">
                <h3 style="margin-bottom: 12px; font-size: 1.1rem;">Preprocessing Pipeline</h3>
                <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 10px; font-weight: 600;">Step</td>
                        <td style="padding: 10px; font-weight: 600;">Purpose</td>
                        <td style="padding: 10px; font-weight: 600;">Time</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 10px;">Quality Filter</td>
                        <td style="padding: 10px;">Remove forwards, auto-replies, too-short emails</td>
                        <td style="padding: 10px;">10 sec</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 10px;">Enrich Metadata</td>
                        <td style="padding: 10px;">Extract recipient type, audience, thread position</td>
                        <td style="padding: 10px;">15 sec</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 10px;">Generate Embeddings</td>
                        <td style="padding: 10px;">Convert to 384-dimensional vectors</td>
                        <td style="padding: 10px;">30 sec</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Cluster</td>
                        <td style="padding: 10px;">Group similar emails (HDBSCAN or K-Means)</td>
                        <td style="padding: 10px;">5 sec</td>
                    </tr>
                </table>
                
                <h3 style="margin: 24px 0 12px; font-size: 1.1rem;">Calibrated Scoring</h3>
                <p style="color: #555; margin-bottom: 8px;">Every email gets 4 dimensions scored 1-10:</p>
                <ul style="margin-left: 20px; color: #555;">
                    <li><strong>Formality:</strong> "yo" (1) ‚Üí "Dear Mr. Smith" (10)</li>
                    <li><strong>Warmth:</strong> "Per request" (1) ‚Üí "So excited!" (10)</li>
                    <li><strong>Authority:</strong> "I think maybe" (1) ‚Üí "This is the approach" (10)</li>
                    <li><strong>Directness:</strong> "wondering if perhaps" (1) ‚Üí "No. Fix it." (10)</li>
                </ul>
                
                <h3 style="margin: 24px 0 12px; font-size: 1.1rem;">Validation</h3>
                <p style="color: #555;">Automatically tests generated prompt against held-out samples using embedding similarity. Threshold: 0.70 (cosine similarity). Typical results: 0.75-0.82.</p>
            </div>
        </div>
        
        <!-- Prerequisites -->
        <div class="section">
            <h2 class="section-title"><span class="icon">‚úÖ</span> Prerequisites</h2>
            <div class="card">
                <ul style="margin-left: 20px;">
                    <li><strong>ChatWise</strong> app installed</li>
                    <li><strong>Gmail MCP</strong> configured in ChatWise (for email access)</li>
                    <li><strong>Python 3.8+</strong> with pip</li>
                    <li><strong>Dependencies:</strong> <code style="background: #f0f0f0; padding: 2px 6px; border-radius: 3px;">pip install sentence-transformers scikit-learn numpy hdbscan</code></li>
                </ul>
            </div>
        </div>
        
        <!-- Privacy -->
        <div class="section">
            <h2 class="section-title"><span class="icon">üîí</span> Privacy & Security</h2>
            <div class="card">
                <ul style="margin-left: 20px; list-style: none;">
                    <li>‚úÖ Everything runs <strong>locally</strong> on your machine</li>
                    <li>‚úÖ Only style patterns are saved, not full email contents</li>
                    <li>‚úÖ Your data folder is <strong>never uploaded</strong> anywhere</li>
                    <li>‚úÖ The skill code is open source on GitHub</li>
                </ul>
            </div>
        </div>
        
        <!-- Troubleshooting -->
        <div class="section">
            <h2 class="section-title"><span class="icon">üîß</span> Troubleshooting</h2>
            <div class="card">
                <div class="troubleshoot-grid">
                    <div class="issue">Buttons don't work</div>
                    <div class="solution">Make sure your assistant ID is exactly <span class="id-highlight">writing-style</span></div>
                    
                    <div class="issue">"Skill not found"</div>
                    <div class="solution">Click "Start Phase 1" - it will install automatically</div>
                    
                    <div class="issue">Stuck in wrong phase</div>
                    <div class="solution">Say "Check my writing style status" to see current state</div>
                    
                    <div class="issue">Want to start over</div>
                    <div class="solution">Ask the AI to delete <code>~/Documents/my-writing-style/</code> and restart</div>
                    
                    <div class="issue">Gmail not working</div>
                    <div class="solution">Check that Gmail MCP is configured in ChatWise settings</div>
                </div>
            </div>
        </div>
        
    </div>
    
    <div class="footer">
        <p><strong>Writing Style Clone v2</strong> ‚Ä¢ Built by John Renaldi ‚Ä¢ January 2025</p>
        <p><a href="https://github.com/jrenaldi79/writing-style">github.com/jrenaldi79/writing-style</a> ‚Ä¢ <a href="README.md">Technical Documentation</a></p>
    </div>
    
    <script>
        // Fetch and inject system prompt from SYSTEM_PROMPT.md
        fetch('SYSTEM_PROMPT.md')
            .then(response => response.text())
            .then(text => {
                // Extract content between PROMPT_START and PROMPT_END markers
                const startMarker = '<!-- PROMPT_START -->';
                const endMarker = '<!-- PROMPT_END -->';
                const startIndex = text.indexOf(startMarker);
                const endIndex = text.indexOf(endMarker);
                
                if (startIndex !== -1 && endIndex !== -1) {
                    const prompt = text.substring(startIndex + startMarker.length, endIndex).trim();
                    document.getElementById('system-prompt').textContent = prompt;
                }
            })
            .catch(err => {
                console.error('Failed to load system prompt:', err);
                document.getElementById('system-prompt').textContent = 'Error loading prompt. See SYSTEM_PROMPT.md';
            });
        
        function copyPrompt(btn, id) {
            const code = document.getElementById(id);
            navigator.clipboard.writeText(code.textContent).then(() => {
                btn.textContent = 'Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'Copy';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>
    
</body>
</html>
